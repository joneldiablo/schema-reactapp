{"version":3,"sources":["../../src/js/components/table-jexcel-v2.jsx"],"names":["TableJexcel","props","el","insertRow","instance","cell","col","row","val","id","editRow","appendChild","img","innerHTML","width","height","table","getElementsByClassName","j","style","e","preventDefault","history","push","target","dataset","ref","eventEmitter","unsubscribe","w","offsetWidth","opts","Object","assign","options","freezeColumns","tableOverflow","updateTable","tableWidth","lazyLoading","subscribe","onResize","document","createElement","anchor","addEventListener","nav","href","loadTable","addRow","React","Component","url","nestedHeaders","title","colspan","columns","name","type"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Link } from \"react-router-dom\";\nimport jexcel from \"jexcel\";\nimport eventEmitter from \"../event-emitter\";\nimport { Route, Switch } from \"react-router-dom/cjs/react-router-dom.min\";\n\n/**\n * version de la tabla con su ruta de consulta de cada fila inmersa\n */\n\nexport default class TableJexcel extends React.Component {\n\n  static defaultProps = {\n    options: {\n      url: 'https://my.api.mockaroo.com/products.json?key=30283510',\n      //data: [],\n      nestedHeaders: [\n        [\n          { title: 'Descripción del Producto o Servicio', colspan: 5 },\n          { title: 'Datos de venta', colspan: 7 },\n        ],\n      ],\n      columns: [\n        {\n          name: 'name',\n          title: 'Nombre',\n          type: 'text',\n          width: 250\n        },\n        {\n          name: 'gallery',\n          title: 'Galería',\n          type: 'text',\n          width: 120\n        },\n        {\n          name: 'description',\n          title: 'Descripción',\n          type: 'text',\n          width: 400\n        },\n        {\n          name: 'category',\n          title: 'Categoría',\n          type: 'text',\n          width: 120\n        },\n        {\n          name: 'tags',\n          title: 'Etiquetas',\n          type: 'text',\n          width: 120\n        },\n        {\n          name: 'price',\n          title: 'Precio',\n          type: 'numeric',\n          width: 80\n        },\n        {\n          name: 'priceSale',\n          title: 'Oferta',\n          type: 'numeric',\n          width: 80\n        },\n        {\n          name: 'unit',\n          title: 'Unidad',\n          type: 'text',\n          width: 80\n        },\n        {\n          name: 'min',\n          title: 'Mínimo',\n          type: 'numeric',\n          width: 80\n        },\n        {\n          name: 'max',\n          title: 'Máximo',\n          type: 'numeric',\n          width: 80\n        },\n        {\n          name: 'step',\n          title: 'Incremento',\n          type: 'numeric',\n          width: 100\n        },\n        {\n          name: 'discounts',\n          title: 'Descuentos',\n          type: 'text',\n          width: 100\n        },\n        {\n          name: 'document',\n          type: 'hidden'\n        },\n      ]\n    },\n  }\n\n  constructor(props) {\n    super(props);\n  }\n\n  addRow = () => {\n    this.el.insertRow();\n  }\n\n  updateTable = (instance, cell, col, row, val, id) => {\n    if (col === 0) {\n      let el = this.editRow(row);\n      cell.appendChild(el);\n    }\n    if (col === 1) {\n      if (!val) return;\n      let img = (`<img src=${val} style=\"height: 40px; width: 100%; object-fit: cover\" />`);\n      cell.innerHTML = img;\n    }\n  }\n\n  onResize = ({ width, height }) => {\n    if (!this.table) return;\n    let [j] = this.table.getElementsByClassName('jexcel_content');\n    if (!j) return;\n    j.style.width = width + 'px';\n    //j.style.maxHeight = height + 'px';\n  }\n\n  nav = (e) => {\n    e.preventDefault();\n    this.props.history.push('/catalogo/' + e.target.dataset.id);\n  }\n\n  loadTable = (ref) => {\n    if (!ref) {\n      eventEmitter.unsubscribe('resize', 'TableJexcel');\n      return;\n    }\n    this.table = ref;\n    let w = ref.offsetWidth - 2;\n    let opts = Object.assign({}, this.props.options,\n      {\n        freezeColumns: 1,\n        tableOverflow: true,\n        updateTable: this.updateTable,\n        tableWidth: w + 'px',\n        lazyLoading: true\n      });\n    this.el = jexcel(ref, opts);\n    eventEmitter.subscribe('resize', this.onResize, 'TableJexcel');\n  }\n\n  componentDidMount() {\n\n  }\n\n  componentWillUnmount() {\n    eventEmitter.unsubscribe('resize', 'TableJexcel');\n  }\n\n  editRow(id) {\n    let el = document.createElement('p');\n    let anchor = document.createElement('a');\n    anchor.innerHTML = 'ver elemento';\n    anchor.addEventListener('click', this.nav);\n    anchor.href = '#';\n    anchor.dataset.id = id;\n    el.appendChild(anchor);\n    return el;\n  }\n\n  render() {\n    return (\n      <div>\n        <Switch>\n          <Route path={'/catalogo/'} exact={true}>\n            <div ref={this.loadTable}></div>\n            <br /><br />\n            <input type='button' value='Add new row' onClick={() => this.addRow()}></input>\n          </Route>\n          <Route path={'/catalogo/:id'}> una ruta muy alocada!!!!</Route>\n        </Switch>\n      </div>\n    );\n  }\n}\n"],"file":"table-jexcel-v2.js"}